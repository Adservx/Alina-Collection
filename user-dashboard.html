<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Alina Collection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="dashboard.css">
</head>
<body class="dashboard-body">
    <!-- Premium Navigation -->
    <section id="header">
      <a href="index.html"><img src="image/Logo/logo.png" class="logo" alt="Alina Collection"/></a>
      <div class="header-search">
        <input type="text" placeholder="Search premium fashion..." id="header-search-input">
        <button type="button" id="header-search-btn"><i class="fas fa-search"></i></button>
      </div>
      <div>
        <ul id="navbar">
          <li><a href="index.html">Home</a></li>
          <li>
            <a href="shop.html">Shop <i class="fas fa-angle-down"></i></a>
            <ul class="dropdown-menu">
                <li><a href="shop.html?cat=Tops">Tops & Shirts</a></li>
                <li><a href="shop.html?cat=Bottoms">Pants & Bottoms</a></li>
                <li><a href="shop.html?cat=Dresses">Dresses</a></li>
                <li><a href="shop.html?cat=Outerwear">Outerwear</a></li>
                <li><a href="shop.html?cat=Footwear">Footwear</a></li>
                <li><a href="shop.html?cat=Accessories">Accessories</a></li>
            </ul>
          </li>
          <li><a href="about.html">Our Story</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="#" onclick="logoutUser()">Logout <i class="fa-solid fa-sign-out-alt"></i></a></li>
        </ul>
      </div>
    </section>

    <div class="dashboard-layout-container">
        <!-- Optional Admin Sidebar (Visible only to David Scot) -->
        <aside id="admin-sidebar" class="admin-sidebar" style="display: none;">
            <div class="sidebar-header">
                <h3>Executive Control</h3>
            </div>
            <ul class="sidebar-nav">
                <li class="active" onclick="switchDashboardView('personal')">
                    <i class="fa-solid fa-user"></i>
                    <span>Personal View</span>
                </li>
                <li onclick="switchDashboardView('admin-overview')">
                    <i class="fa-solid fa-chart-pie"></i>
                    <span>System Intelligence</span>
                </li>
                <li onclick="switchDashboardView('admin-inventory')">
                    <i class="fa-solid fa-boxes-stacked"></i>
                    <span>Inventory Vault</span>
                </li>
                <li onclick="switchDashboardView('admin-orders')">
                    <i class="fa-solid fa-receipt"></i>
                    <span>Order Fulfillment</span>
                </li>
                <li onclick="switchDashboardView('admin-users')">
                    <i class="fa-solid fa-user-shield"></i>
                    <span>Citizen Registry</span>
                </li>
            </ul>
            <div class="sidebar-footer">
                <p>Â© 2026 Sovereign Access</p>
            </div>
        </aside>

        <main class="main-content fade-in">
            
            <!-- SECTION: Personal Dashboard (Standard User View) -->
            <div id="personal-view" class="dashboard-section">
                <!-- 1. Profile Header (Welcome) -->
                <div class="profile-header-card">
                    <div class="profile-bg-overlay"></div>
                    <div class="profile-info-main">
                        <div class="avatar-container">
                            <div class="profile-avatar" id="avatar-preview">
                                <i class="fa-solid fa-user"></i>
                            </div>
                            <label for="profile-upload" class="avatar-edit-btn">
                                <i class="fa-solid fa-camera"></i>
                                <input type="file" id="profile-upload" accept="image/*" style="display: none;">
                            </label>
                        </div>
                        <div class="profile-text">
                            <h2 id="user-greeting-large">Hello, User!</h2>
                            <p id="user-email-small">user@example.com</p>
                            <span class="role-badge" id="user-role-badge"><i class="fa-solid fa-user"></i> User</span>
                        </div>
                    </div>
                    <div class="profile-stats-summary">
                        <div class="summary-item">
                            <span class="summary-value" id="count-orders">0</span>
                            <span class="summary-label">Orders</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-value" id="count-wishlist">0</span>
                            <span class="summary-label">Wishlist</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-value" id="count-spent">NPR 0</span>
                            <span class="summary-label">Total Spent</span>
                        </div>
                        <div class="summary-item premium-points">
                            <span class="summary-value" id="loyalty-points">0</span>
                            <span class="summary-label">Alina Points</span>
                        </div>
                    </div>
                </div>

                <!-- Loyalty Program Section -->
                <div class="dash-card loyalty-card fade-in">
                    <div class="loyalty-content">
                        <div class="loyalty-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="loyalty-text">
                            <h3>Alina Insider Rewards</h3>
                            <p>You're earning 1 point for every NPR 100 spent. Redeem points for exclusive discounts!</p>
                            <div class="progress-container">
                                <div class="progress-bar" id="points-progress" style="width: 0%;"></div>
                            </div>
                            <span id="points-needed">Spend NPR 500 more to reach Silver tier</span>
                        </div>
                        <button class="normal gold-btn" onclick="showToast('Feature coming soon!!!')">Redeem Points</button>
                    </div>
                </div>

                <!-- Dashboard Overview Sections (My Cart, My Wishlist, Track Order) -->
                <div class="dashboard-grid-3">
                    <!-- My Cart Section -->
                    <div id="cart-section" class="section-wrapper-mini">
                        <div class="dash-card">
                            <div class="dash-header-modern">
                                <h3><i class="fa-solid fa-cart-shopping"></i> My Cart</h3>
                                <a href="cart.html" class="view-link">View Full Cart</a>
                            </div>
                            <div class="mini-list" id="mini-cart-list">
                                <!-- Injected by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- My Wishlist Section -->
                    <div id="wishlist-section" class="section-wrapper-mini">
                        <div class="dash-card">
                            <div class="dash-header-modern">
                                <h3><i class="fa-solid fa-heart"></i> My Wishlist</h3>
                                <a href="shop.html" class="view-link">Add More</a>
                            </div>
                            <div class="mini-list" id="mini-wishlist-list">
                                <!-- Injected by JS -->
                            </div>
                        </div>
                    </div>

                    <!-- Track Order Section -->
                    <div id="track-section" class="section-wrapper-mini">
                        <div class="dash-card">
                            <div class="dash-header-modern">
                                <h3><i class="fa-solid fa-truck-fast"></i> Track Order</h3>
                            </div>
                            <div class="track-box">
                                <p>Enter your Order ID to see real-time status.</p>
                                <div class="track-input-group">
                                    <input type="text" id="track-id-input" placeholder="e.g. #1001">
                                    <button onclick="trackOrder()"><i class="fa-solid fa-magnifying-glass"></i></button>
                                </div>
                                <div id="track-result" class="track-result"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section (Account Setting) -->
                <div id="settings-section" class="section-wrapper">
                    <div class="dash-card advanced-settings">
                        <div class="settings-header">
                            <h3><i class="fa-solid fa-user-gear"></i> Personal Configuration</h3>
                            <p>Keep your profile up to date for a better shopping experience.</p>
                        </div>
                        
                        <form id="profile-form">
                            <div class="settings-grid">
                                <!-- Personal Details -->
                                <div class="settings-section">
                                    <h4 class="section-title">Identity</h4>
                                    <div class="input-group">
                                        <label>Full Name</label>
                                        <div class="input-wrapper">
                                            <i class="fa-solid fa-signature"></i>
                                            <input type="text" id="set-name" placeholder="Enter your full name">
                                        </div>
                                    </div>
                                    <div class="input-group">
                                        <label>Email Address</label>
                                        <div class="input-wrapper disabled">
                                            <i class="fa-solid fa-envelope"></i>
                                            <input type="email" id="set-email" disabled>
                                            <i class="fa-solid fa-lock lock-icon"></i>
                                        </div>
                                    </div>
                                    <div class="input-group">
                                        <label>Phone Number</label>
                                        <div class="input-wrapper">
                                            <i class="fa-solid fa-phone"></i>
                                            <input type="tel" id="set-phone" placeholder="Enter phone number">
                                        </div>
                                    </div>
                                    <div class="input-row">
                                        <div class="input-group">
                                            <label>Date of Birth</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-calendar"></i>
                                                <input type="date" id="set-dob">
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <label>Gender</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-venus-mars"></i>
                                                <select id="set-gender">
                                                    <option value="">Select Gender</option>
                                                    <option value="male">Male</option>
                                                    <option value="female">Female</option>
                                                    <option value="other">Other</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Address Information -->
                                <div class="settings-section">
                                    <h4 class="section-title">Delivery Address</h4>
                                    <div class="input-row">
                                        <div class="input-group" style="flex: 1;">
                                            <label>House / Flat No.</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-house-user"></i>
                                                <input type="text" id="set-house" placeholder="#101">
                                            </div>
                                        </div>
                                        <div class="input-group" style="flex: 2;">
                                            <label>Street Address</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-road"></i>
                                                <input type="text" id="set-address" placeholder="e.g. Main Street, Ward 4">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-row">
                                        <div class="input-group">
                                            <label>City</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-city"></i>
                                                <input type="text" id="set-city" placeholder="e.g. Kathmandu">
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <label>Province / State</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-map"></i>
                                                <input type="text" id="set-province" placeholder="e.g. Bagmati">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="input-row">
                                        <div class="input-group">
                                            <label>Country</label>
                                            <div class="input-wrapper">
                                                <i class="fa-solid fa-earth-americas"></i>
                                                <select id="set-country">
                                                    <option value="Nepal">Nepal</option>
                                                    <option value="India">India</option>
                                                    <option value="USA">USA</option>
                                                    <option value="UK">UK</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions-modern">
                                <button type="submit" class="normal btn-save-modern">
                                    <span>Save Changes</span>
                                    <i class="fa-solid fa-check"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Purchase History -->
                <div id="orders-section" class="section-wrapper">
                    <div class="dash-card">
                        <div class="dash-header-modern">
                            <h3><i class="fa-solid fa-clock-rotate-left"></i> Purchase History</h3>
                            <p>Track and manage your recent orders.</p>
                        </div>
                        <div class="table-responsive">
                            <table class="order-table-modern" id="user-order-table">
                                <thead>
                                    <tr>
                                        <th>Reference</th>
                                        <th>Date</th>
                                        <th>Product Details</th>
                                        <th>Amount</th>
                                        <th>Tracking Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Orders injected by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION: Admin Intelligence -->
            <div id="admin-overview" class="dashboard-section" style="display: none;">
                <div class="section-header-modern">
                    <div>
                        <h1>System Intelligence</h1>
                        <p>Real-time analytics and performance metrics for Alina Collection.</p>
                    </div>
                    <div class="date-display" id="current-date">January 21, 2026</div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card premium">
                        <div class="stat-icon"><i class="fa-solid fa-coins"></i></div>
                        <div class="stat-info">
                            <p>Gross Revenue</p>
                            <h3 id="stat-total-sales">NPR 0</h3>
                        </div>
                        <div class="stat-trend positive">+12.5%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fa-solid fa-shopping-bag"></i></div>
                        <div class="stat-info">
                            <p>Total Acquisitions</p>
                            <h3 id="stat-total-orders">0</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon"><i class="fa-solid fa-users"></i></div>
                        <div class="stat-info">
                            <p>Global Members</p>
                            <h3 id="stat-total-users">0</h3>
                        </div>
                    </div>
                    <div class="stat-card alert">
                        <div class="stat-icon"><i class="fa-solid fa-triangle-exclamation"></i></div>
                        <div class="stat-info">
                            <p>Low Stock Alerts</p>
                            <h3 id="stat-low-stock">0</h3>
                        </div>
                    </div>
                </div>

                <div class="dashboard-split-grid">
                    <div class="data-card">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> Recent Activity Log</h3>
                        </div>
                        <div class="table-responsive">
                            <table id="admin-recent-order-table">
                                <thead>
                                    <tr>
                                        <th>Log ID</th>
                                        <th>Client</th>
                                        <th>Asset Value</th>
                                        <th>Fulfillment</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Injected by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="data-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> Inventory Velocity</h3>
                        </div>
                        <div class="inventory-performance-viz">
                            <div class="chart-mock">
                                <div class="bar" style="height: 80%;" data-label="Tops"></div>
                                <div class="bar" style="height: 45%;" data-label="Bottoms"></div>
                                <div class="bar" style="height: 95%;" data-label="Dresses"></div>
                                <div class="bar" style="height: 30%;" data-label="Outerwear"></div>
                                <div class="bar" style="height: 60%;" data-label="Heritage"></div>
                            </div>
                        </div>
                        <div id="inventory-summary-list" class="mt-4">
                            <!-- Injected by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- SECTION: Inventory Vault -->
            <div id="admin-inventory" class="dashboard-section" style="display: none;">
                <div class="section-header-modern">
                    <div>
                        <h1>Inventory Vault</h1>
                        <p>Curate, add, or refine the Alina Collection catalogue.</p>
                    </div>
                    <button class="premium-btn" onclick="openProductModal()">
                        <i class="fas fa-plus"></i> New Addition
                    </button>
                </div>

                <div class="data-card">
                    <div class="table-responsive">
                        <table id="admin-product-table">
                            <thead>
                                <tr>
                                    <th>Visual</th>
                                    <th>Designation</th>
                                    <th>House/Cat</th>
                                    <th>Valuation</th>
                                    <th>Reserves</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Data injected by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SECTION: Order Fulfillment -->
            <div id="admin-orders" class="dashboard-section" style="display: none;">
                <div class="section-header-modern">
                    <div>
                        <h1>Order Fulfillment</h1>
                        <p>Monitor and manage the lifecycle of every transaction.</p>
                    </div>
                </div>
                <div class="data-card">
                    <div class="table-responsive">
                        <table id="admin-full-order-table">
                            <thead>
                                <tr>
                                    <th>Reference</th>
                                    <th>Date</th>
                                    <th>Client Detail</th>
                                    <th>Amount</th>
                                    <th>Fulfillment</th>
                                    <th>Control</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Injected by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- SECTION: User Registry -->
            <div id="admin-users" class="dashboard-section" style="display: none;">
                <div class="section-header-modern">
                    <div>
                        <h1>Citizen Registry</h1>
                        <p>Managing access and memberships for the Alina Circle.</p>
                    </div>
                </div>
                <div class="data-card">
                    <div class="table-responsive">
                        <table id="admin-user-table">
                            <thead>
                                <tr>
                                    <th>Identifier</th>
                                    <th>Contact</th>
                                    <th>Authority</th>
                                    <th>Control</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Injected by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Premium Product Modal (shared for Admin Inventory) -->
    <div id="product-modal" class="modal-overlay">
        <div class="modal-content admin-modal">
            <div class="modal-header">
                <h2 id="modal-title">Product Configuration</h2>
                <button class="close-modal" onclick="closeProductModal()">&times;</button>
            </div>
            <form id="product-form" onsubmit="saveProduct(event)">
                <input type="hidden" id="edit-id">
                <div class="modal-body">
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Product Designation</label>
                            <input type="text" id="edit-name" placeholder="e.g. Signature Silk Saree" required>
                        </div>
                        <div class="input-group">
                            <label>Design House / Brand</label>
                            <input type="text" id="edit-brand" placeholder="e.g. Alina Boutique" required>
                        </div>
                    </div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label>Price (NPR)</label>
                            <input type="number" id="edit-price" placeholder="0.00" required>
                        </div>
                        <div class="input-group">
                            <label>Inventory Reserves</label>
                            <input type="number" id="edit-stock" placeholder="0" required>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Category</label>
                        <select id="edit-cat">
                            <option value="Tops">Tops & Shirts</option>
                            <option value="Bottoms">Pants & Bottoms</option>
                            <option value="Dresses">Dresses</option>
                            <option value="Outerwear">Outerwear</option>
                            <option value="Footwear">Footwear</option>
                            <option value="Accessories">Accessories</option>
                            <option value="Nepali Heritage">Nepali Heritage</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Imagery URL</label>
                        <input type="text" id="edit-image" placeholder="https://...">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" onclick="closeProductModal()">Discard</button>
                    <button type="submit" class="btn-confirm">Authorize Changes</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
             const user = JSON.parse(localStorage.getItem('currentUser'));
             if (!user) {
                 window.location.href = 'login.html';
                 return;
             }
             
             // UNIFIED DASHBOARD LOGIC
             if (user.role === 'admin') {
                 // Show sidebar for David Scot
                 document.getElementById('admin-sidebar').style.display = 'flex';
                 document.querySelector('.dashboard-layout-container').classList.add('admin-active');
                 
                 // Initial Administrative Render
                 renderAdminDashboard();
                 document.getElementById('current-date').innerText = new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
             }

             // Initial greeting
             document.getElementById('user-greeting-large').innerText = `Hello, ${user.name}!`;
             document.getElementById('user-email-small').innerText = user.email;

             // Set Role Badge
             const roleBadge = document.getElementById('user-role-badge');
             if (user.role === 'admin') {
                 roleBadge.innerHTML = `<i class="fa-solid fa-user-shield"></i> Sovereign Admin`;
                 roleBadge.className = 'role-badge role-admin';
             } else {
                 roleBadge.innerHTML = `<i class="fa-solid fa-user"></i> User`;
                 roleBadge.className = 'role-badge role-user';
             }

             // Load Profile Picture
             if (user.profilePic) {
                 document.getElementById('avatar-preview').innerHTML = `<img src="${user.profilePic}" alt="Profile">`;
             }
             
             // Fill personal settings form
             document.getElementById('set-name').value = user.name || "";
             document.getElementById('set-email').value = user.email || "";
             document.getElementById('set-phone').value = user.phone || "";
             document.getElementById('set-dob').value = user.dob || "";
             document.getElementById('set-gender').value = user.gender || "";
             document.getElementById('set-house').value = user.house || "";
             document.getElementById('set-address').value = user.address || "";
             document.getElementById('set-city').value = user.city || "";
             document.getElementById('set-province').value = user.province || "";
             document.getElementById('set-country').value = user.country || "Nepal";

             // Profile Form Submission
             const profileForm = document.getElementById('profile-form');
             profileForm.addEventListener('submit', (e) => {
                 e.preventDefault();
                 
                 const updatedUser = {
                     ...user,
                     name: document.getElementById('set-name').value,
                     phone: document.getElementById('set-phone').value,
                     dob: document.getElementById('set-dob').value,
                     gender: document.getElementById('set-gender').value,
                     house: document.getElementById('set-house').value,
                     address: document.getElementById('set-address').value,
                     city: document.getElementById('set-city').value,
                     province: document.getElementById('set-province').value,
                     country: document.getElementById('set-country').value
                 };

                 localStorage.setItem('currentUser', JSON.stringify(updatedUser));
                 
                 let allUsers = JSON.parse(localStorage.getItem('users')) || [];
                 const userIndex = allUsers.findIndex(u => u.email === updatedUser.email);
                 if (userIndex !== -1) {
                     allUsers[userIndex] = updatedUser;
                     localStorage.setItem('users', JSON.stringify(allUsers));
                 }

                 showToast('Configuration Updated Successfully');
                 document.getElementById('user-greeting-large').innerText = `Hello, ${updatedUser.name}!`;
             });

             // Profile Picture Upload Logic
             const profileUpload = document.getElementById('profile-upload');
             profileUpload.addEventListener('change', function(e) {
                 const file = e.target.files[0];
                 if (file) {
                     const reader = new FileReader();
                     reader.onload = function(event) {
                         const dataUrl = event.target.result;
                         document.getElementById('avatar-preview').innerHTML = `<img src="${dataUrl}" alt="Profile">`;
                         
                         const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                         currentUser.profilePic = dataUrl;
                         localStorage.setItem('currentUser', JSON.stringify(currentUser));
                         
                         let allUsers = JSON.parse(localStorage.getItem('users')) || [];
                         const userIndex = allUsers.findIndex(u => u.email === currentUser.email);
                         if (userIndex !== -1) {
                             allUsers[userIndex].profilePic = dataUrl;
                             localStorage.setItem('users', JSON.stringify(allUsers));
                         }
                         showToast('Avatar Synced');
                     };
                     reader.readAsDataURL(file);
                 }
             });

             renderUserOrders(user.email);
             renderDashboardCart();
             renderDashboardWishlist();
             
             // Metrics for Admin
             const allOrders = JSON.parse(localStorage.getItem('orders')) || [];
             const userOrders = allOrders.filter(o => o.userEmail === user.email);
             const wishlistCount = JSON.parse(localStorage.getItem('wishlist'))?.length || 0;
             const totalSpent = userOrders.reduce((sum, o) => sum + o.total, 0);

             document.getElementById('count-orders').innerText = userOrders.length;
             document.getElementById('count-wishlist').innerText = wishlistCount;
             document.getElementById('count-spent').innerText = `NPR ${totalSpent}`;
             
             // Loyalty
             const points = Math.floor(totalSpent / 100);
             document.getElementById('loyalty-points').innerText = points;
             const progress = (points % 500) / 5;
             document.getElementById('points-progress').style.width = progress + "%";
             const needed = 500 - (points % 500);
             document.getElementById('points-needed').innerText = `Earn ${needed} more points to reach the next tier!`;
        });

        function switchDashboardView(viewId) {
            const sections = document.querySelectorAll('.dashboard-section');
            
            // Fade out current
            sections.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    el.style.display = 'none';
                }, 300);
            });
            
            // Switch & Fade in
            setTimeout(() => {
                let target;
                if (viewId === 'personal') target = document.getElementById('personal-view');
                else target = document.getElementById(viewId);

                if(target) {
                    target.style.display = 'block';
                    setTimeout(() => {
                        target.style.opacity = '1';
                        target.style.transform = 'translateY(0)';
                    }, 50);
                }
            }, 305);

            // Sidebar Active State
            document.querySelectorAll('.sidebar-nav li').forEach(el => el.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');
        }

        function logoutUser() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>